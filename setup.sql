-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;

CREATE TABLE IF NOT EXISTS PUBLIC.FEATURECLASS (
	FID SMALLINT NOT NULL,
	FCLASS TEXT COLLATE PG_CATALOG."default",
	CONSTRAINT FEATURECLASS_PKEY PRIMARY KEY (FID)
);

CREATE TABLE IF NOT EXISTS PUBLIC.REF (
	RID BIGINT NOT NULL DEFAULT NEXTVAL('ref_id'::REGCLASS),
	REF TEXT COLLATE PG_CATALOG."default",
	CONSTRAINT REF_PKEY PRIMARY KEY (RID)
);

CREATE TABLE IF NOT EXISTS PUBLIC.REFMANY (
	ROAD_ID INTEGER NOT NULL,
	REF_ID BIGINT NOT NULL,
	CONSTRAINT REFMANY_PKEY PRIMARY KEY (ROAD_ID, REF_ID)
);

CREATE TABLE IF NOT EXISTS PUBLIC.ROADNAME (NID INTEGER, NAME TEXT COLLATE PG_CATALOG."default");

CREATE TABLE IF NOT EXISTS PUBLIC.ROADS (
	ID INTEGER NOT NULL,
	OSM_ID BIGINT NOT NULL,
	CODE SMALLINT NOT NULL,
	ONEWAY CHARACTER VARYING(1) COLLATE PG_CATALOG."default" NOT NULL,
	MAXSPEED SMALLINT NOT NULL,
	LAYER SMALLINT NOT NULL,
	BRIDGE BOOLEAN NOT NULL,
	TUNNEL BOOLEAN NOT NULL,
	GEOM GEOMETRY NOT NULL,
	CONSTRAINT ROADS_PKEY PRIMARY KEY (ID)
);

ALTER TABLE IF EXISTS PUBLIC.REFMANY
ADD CONSTRAINT REFMANY_REF_ID_FKEY FOREIGN KEY (REF_ID) REFERENCES PUBLIC.REF (RID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION NOT VALID;

ALTER TABLE IF EXISTS PUBLIC.REFMANY
ADD CONSTRAINT REFMANY_ROAD_ID_FKEY FOREIGN KEY (ROAD_ID) REFERENCES PUBLIC.ROADS (ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION NOT VALID;

ALTER TABLE IF EXISTS PUBLIC.ROADNAME
ADD CONSTRAINT ROADNAME_NID_FKEY FOREIGN KEY (NID) REFERENCES PUBLIC.ROADS (ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION NOT VALID;

ALTER TABLE IF EXISTS PUBLIC.ROADS
ADD CONSTRAINT ROADS_CODE_FKEY FOREIGN KEY (CODE) REFERENCES PUBLIC.FEATURECLASS (FID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION NOT VALID;

ALTER TABLE ROADS
ADD COLUMN IF NOT EXISTS DIRECTION VARCHAR(1);

END;
